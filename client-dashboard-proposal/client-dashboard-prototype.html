<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>ILV Executive Dashboard - Advanced Analytics</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/2.2.0/chartjs-plugin-datalabels.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-treemap@2.3.0/dist/chartjs-chart-treemap.min.js"></script>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            :root {
                --primary-bg: #0a0a0f;
                --secondary-bg: #13131a;
                --card-bg: #1a1a24;
                --card-hover: #1f1f2a;
                --border-color: #2a2a3e;
                --text-primary: #ffffff;
                --text-secondary: #a0a0b0;
                --accent-blue: #3b82f6;
                --accent-purple: #8b5cf6;
                --accent-green: #10b981;
                --accent-red: #ef4444;
                --accent-yellow: #f59e0b;
                --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
                --gradient-4: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            }

            body {
                font-family:
                    -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial,
                    sans-serif;
                background-color: var(--primary-bg);
                color: var(--text-primary);
                line-height: 1.6;
                overflow-x: hidden;
            }

            /* Loading Screen */
            .loading-screen {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: var(--primary-bg);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                transition: opacity 0.5s ease;
            }

            .loading-content {
                text-align: center;
            }

            .loading-logo {
                width: 80px;
                height: 80px;
                margin: 0 auto 20px;
                border: 3px solid var(--accent-blue);
                border-radius: 50%;
                border-top-color: transparent;
                animation: spin 1s linear infinite;
            }

            @keyframes spin {
                0% {
                    transform: rotate(0deg);
                }
                100% {
                    transform: rotate(360deg);
                }
            }

            /* Header */
            .header {
                background: var(--secondary-bg);
                border-bottom: 1px solid var(--border-color);
                position: sticky;
                top: 0;
                z-index: 1000;
                backdrop-filter: blur(10px);
                background: rgba(19, 19, 26, 0.95);
            }

            .header-content {
                max-width: 1800px;
                margin: 0 auto;
                padding: 20px;
                display: flex;
                justify-content: space-between;
                align-items: center;
                flex-wrap: wrap;
                gap: 20px;
            }

            .logo-section {
                display: flex;
                align-items: center;
                gap: 15px;
            }

            .logo {
                width: 40px;
                height: 40px;
                background: var(--gradient-1);
                border-radius: 10px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: bold;
                font-size: 18px;
            }

            h1 {
                font-size: 1.8rem;
                font-weight: 600;
                background: var(--gradient-3);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
            }

            .header-controls {
                display: flex;
                gap: 15px;
                align-items: center;
            }

            .date-range-selector {
                display: flex;
                gap: 10px;
                align-items: center;
                background: var(--card-bg);
                padding: 8px 15px;
                border-radius: 10px;
                border: 1px solid var(--border-color);
            }

            .date-range-selector input {
                background: transparent;
                border: none;
                color: var(--text-primary);
                outline: none;
                padding: 5px;
            }

            .btn {
                background: var(--card-bg);
                border: 1px solid var(--border-color);
                color: var(--text-primary);
                padding: 10px 20px;
                border-radius: 10px;
                cursor: pointer;
                font-size: 0.9rem;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                gap: 8px;
            }

            .btn:hover {
                background: var(--card-hover);
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            }

            .btn-primary {
                background: var(--gradient-1);
                border: none;
            }

            .btn-icon {
                font-size: 1.1rem;
            }

            /* Main Container */
            .dashboard-container {
                max-width: 1800px;
                margin: 0 auto;
                padding: 20px;
            }

            /* Metrics Cards */
            .metrics-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
                gap: 20px;
                margin-bottom: 30px;
            }

            .metric-card {
                background: var(--card-bg);
                border: 1px solid var(--border-color);
                border-radius: 15px;
                padding: 25px;
                position: relative;
                overflow: hidden;
                transition: all 0.3s ease;
                cursor: pointer;
            }

            .metric-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
                background: var(--card-hover);
            }

            .metric-card::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 4px;
                background: var(--gradient-1);
            }

            .metric-icon {
                width: 50px;
                height: 50px;
                background: rgba(59, 130, 246, 0.1);
                border-radius: 12px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 24px;
                margin-bottom: 15px;
            }

            .metric-label {
                font-size: 0.85rem;
                color: var(--text-secondary);
                text-transform: uppercase;
                letter-spacing: 1px;
                margin-bottom: 8px;
            }

            .metric-value {
                font-size: 2.2rem;
                font-weight: 700;
                margin-bottom: 10px;
                display: flex;
                align-items: baseline;
                gap: 10px;
            }

            .metric-change {
                font-size: 0.9rem;
                display: flex;
                align-items: center;
                gap: 5px;
            }

            .metric-sparkline {
                position: absolute;
                bottom: 0;
                right: 0;
                width: 100px;
                height: 40px;
                opacity: 0.3;
            }

            .positive {
                color: var(--accent-green);
            }

            .negative {
                color: var(--accent-red);
            }

            .neutral {
                color: var(--text-secondary);
            }

            /* Tabs */
            .tabs-container {
                background: var(--card-bg);
                border-radius: 15px;
                padding: 5px;
                margin-bottom: 25px;
                display: flex;
                gap: 5px;
                overflow-x: auto;
                border: 1px solid var(--border-color);
            }

            .tab {
                padding: 12px 24px;
                background: transparent;
                border: none;
                color: var(--text-secondary);
                cursor: pointer;
                border-radius: 10px;
                font-size: 0.95rem;
                font-weight: 500;
                transition: all 0.3s ease;
                white-space: nowrap;
            }

            .tab:hover {
                background: rgba(255, 255, 255, 0.05);
            }

            .tab.active {
                background: var(--gradient-1);
                color: white;
            }

            /* Chart Containers */
            .charts-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
                gap: 25px;
                margin-bottom: 30px;
            }

            .chart-container {
                background: var(--card-bg);
                border: 1px solid var(--border-color);
                border-radius: 15px;
                padding: 25px;
                transition: all 0.3s ease;
                position: relative;
            }

            .chart-container:hover {
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            }

            .chart-container.full-width {
                grid-column: 1 / -1;
            }

            .chart-container.large {
                grid-column: span 2;
            }

            .chart-header {
                display: flex;
                justify-content: space-between;
                align-items: flex-start;
                margin-bottom: 25px;
                flex-wrap: wrap;
                gap: 15px;
            }

            .chart-title {
                font-size: 1.3rem;
                font-weight: 600;
                color: var(--text-primary);
            }

            .chart-subtitle {
                font-size: 0.85rem;
                color: var(--text-secondary);
                margin-top: 5px;
            }

            .chart-controls {
                display: flex;
                gap: 10px;
                flex-wrap: wrap;
            }

            .chart-btn {
                background: var(--secondary-bg);
                border: 1px solid var(--border-color);
                color: var(--text-secondary);
                padding: 8px 16px;
                border-radius: 8px;
                cursor: pointer;
                font-size: 0.85rem;
                transition: all 0.3s ease;
            }

            .chart-btn:hover {
                background: var(--card-hover);
                color: var(--text-primary);
            }

            .chart-btn.active {
                background: var(--accent-blue);
                color: white;
                border-color: var(--accent-blue);
            }

            canvas {
                max-height: 400px;
            }

            /* Interactive Table */
            .data-table-container {
                overflow-x: auto;
                border-radius: 10px;
                border: 1px solid var(--border-color);
            }

            .data-table {
                width: 100%;
                border-collapse: collapse;
            }

            .data-table th,
            .data-table td {
                padding: 15px;
                text-align: left;
                border-bottom: 1px solid var(--border-color);
            }

            .data-table th {
                background: var(--secondary-bg);
                font-weight: 600;
                color: var(--text-secondary);
                font-size: 0.85rem;
                text-transform: uppercase;
                letter-spacing: 1px;
                position: sticky;
                top: 0;
                z-index: 10;
            }

            .data-table tr:hover {
                background: rgba(255, 255, 255, 0.02);
            }

            .data-table td {
                font-size: 0.95rem;
            }

            .table-badge {
                padding: 4px 12px;
                border-radius: 20px;
                font-size: 0.8rem;
                font-weight: 500;
                display: inline-block;
            }

            .badge-active {
                background: rgba(16, 185, 129, 0.2);
                color: var(--accent-green);
            }

            .badge-new {
                background: rgba(59, 130, 246, 0.2);
                color: var(--accent-blue);
            }

            .badge-pipeline {
                background: rgba(245, 158, 11, 0.2);
                color: var(--accent-yellow);
            }

            .performance-bar {
                width: 100%;
                height: 6px;
                background: var(--secondary-bg);
                border-radius: 3px;
                overflow: hidden;
                margin-top: 5px;
            }

            .performance-fill {
                height: 100%;
                transition: width 0.5s ease;
            }

            /* Filter Panel */
            .filter-panel {
                background: var(--card-bg);
                border: 1px solid var(--border-color);
                border-radius: 15px;
                padding: 20px;
                margin-bottom: 25px;
                display: none;
            }

            .filter-panel.active {
                display: block;
            }

            .filter-group {
                margin-bottom: 20px;
            }

            .filter-label {
                font-size: 0.9rem;
                color: var(--text-secondary);
                margin-bottom: 10px;
                display: block;
            }

            .filter-options {
                display: flex;
                gap: 10px;
                flex-wrap: wrap;
            }

            .filter-chip {
                background: var(--secondary-bg);
                border: 1px solid var(--border-color);
                padding: 8px 16px;
                border-radius: 20px;
                cursor: pointer;
                font-size: 0.85rem;
                transition: all 0.3s ease;
            }

            .filter-chip:hover {
                background: var(--card-hover);
            }

            .filter-chip.active {
                background: var(--accent-blue);
                color: white;
                border-color: var(--accent-blue);
            }

            /* Modal */
            .modal {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                z-index: 2000;
                overflow-y: auto;
            }

            .modal.active {
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .modal-content {
                background: var(--card-bg);
                border: 1px solid var(--border-color);
                border-radius: 20px;
                padding: 40px;
                max-width: 900px;
                width: 90%;
                max-height: 90vh;
                overflow-y: auto;
                position: relative;
            }

            .modal-close {
                position: absolute;
                top: 20px;
                right: 20px;
                background: var(--secondary-bg);
                border: 1px solid var(--border-color);
                width: 40px;
                height: 40px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                font-size: 20px;
                transition: all 0.3s ease;
            }

            .modal-close:hover {
                background: var(--card-hover);
                transform: rotate(90deg);
            }

            /* Tooltips */
            .tooltip {
                position: absolute;
                background: rgba(0, 0, 0, 0.95);
                color: white;
                padding: 12px 16px;
                border-radius: 10px;
                font-size: 0.85rem;
                pointer-events: none;
                opacity: 0;
                transition: opacity 0.3s ease;
                z-index: 3000;
                max-width: 300px;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            }

            .tooltip.visible {
                opacity: 1;
            }

            .tooltip-title {
                font-weight: 600;
                margin-bottom: 5px;
            }

            .tooltip-value {
                color: var(--accent-blue);
            }

            /* Search Bar */
            .search-container {
                position: relative;
                margin-bottom: 20px;
            }

            .search-input {
                width: 100%;
                background: var(--secondary-bg);
                border: 1px solid var(--border-color);
                border-radius: 10px;
                padding: 12px 20px 12px 45px;
                color: var(--text-primary);
                font-size: 0.95rem;
                outline: none;
                transition: all 0.3s ease;
            }

            .search-input:focus {
                border-color: var(--accent-blue);
                box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            }

            .search-icon {
                position: absolute;
                left: 15px;
                top: 50%;
                transform: translateY(-50%);
                color: var(--text-secondary);
            }

            /* Export Menu */
            .export-menu {
                position: absolute;
                top: 100%;
                right: 0;
                background: var(--card-bg);
                border: 1px solid var(--border-color);
                border-radius: 10px;
                padding: 10px;
                margin-top: 5px;
                display: none;
                min-width: 180px;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            }

            .export-menu.active {
                display: block;
            }

            .export-option {
                padding: 10px 15px;
                cursor: pointer;
                border-radius: 8px;
                display: flex;
                align-items: center;
                gap: 10px;
                transition: all 0.3s ease;
            }

            .export-option:hover {
                background: var(--secondary-bg);
            }

            /* Alert Banner */
            .alert-banner {
                background: var(--gradient-2);
                padding: 15px 20px;
                border-radius: 10px;
                margin-bottom: 20px;
                display: flex;
                align-items: center;
                justify-content: space-between;
                animation: slideIn 0.5s ease;
            }

            @keyframes slideIn {
                from {
                    transform: translateY(-20px);
                    opacity: 0;
                }
                to {
                    transform: translateY(0);
                    opacity: 1;
                }
            }

            .alert-content {
                display: flex;
                align-items: center;
                gap: 15px;
            }

            .alert-icon {
                font-size: 24px;
            }

            .alert-text {
                font-weight: 500;
            }

            .alert-close {
                cursor: pointer;
                opacity: 0.8;
                transition: opacity 0.3s ease;
            }

            .alert-close:hover {
                opacity: 1;
            }

            /* Responsive */
            @media (max-width: 1200px) {
                .charts-grid {
                    grid-template-columns: 1fr;
                }

                .chart-container.large {
                    grid-column: 1;
                }
            }

            @media (max-width: 768px) {
                .header-content {
                    flex-direction: column;
                    align-items: stretch;
                }

                .metrics-grid {
                    grid-template-columns: 1fr;
                }

                .modal-content {
                    padding: 25px;
                }

                h1 {
                    font-size: 1.5rem;
                }
            }

            /* File Upload */
            .file-upload-area {
                border: 2px dashed var(--border-color);
                border-radius: 10px;
                padding: 40px;
                text-align: center;
                transition: all 0.3s ease;
                cursor: pointer;
                margin-bottom: 20px;
            }

            .file-upload-area:hover {
                border-color: var(--accent-blue);
                background: rgba(59, 130, 246, 0.05);
            }

            .file-upload-area.dragover {
                border-color: var(--accent-green);
                background: rgba(16, 185, 129, 0.1);
            }

            .upload-icon {
                font-size: 48px;
                margin-bottom: 15px;
                opacity: 0.5;
            }

            .upload-text {
                color: var(--text-secondary);
                margin-bottom: 10px;
            }

            .upload-button {
                background: var(--gradient-1);
                color: white;
                padding: 10px 25px;
                border-radius: 8px;
                border: none;
                cursor: pointer;
                font-size: 0.9rem;
                transition: all 0.3s ease;
            }

            .upload-button:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            }

            /* Animations */
            .fade-in {
                animation: fadeIn 0.5s ease;
            }

            @keyframes fadeIn {
                from {
                    opacity: 0;
                    transform: translateY(20px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            .pulse {
                animation: pulse 2s infinite;
            }

            @keyframes pulse {
                0% {
                    box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7);
                }
                70% {
                    box-shadow: 0 0 0 10px rgba(59, 130, 246, 0);
                }
                100% {
                    box-shadow: 0 0 0 0 rgba(59, 130, 246, 0);
                }
            }
        </style>
    </head>
    <body>
        <!-- Loading Screen -->
        <div class="loading-screen" id="loadingScreen">
            <div class="loading-content">
                <div class="loading-logo"></div>
                <h2>Loading Dashboard...</h2>
            </div>
        </div>

        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo">ILV</div>
                    <div>
                        <h1>Executive Dashboard</h1>
                        <div class="chart-subtitle">Real-time Portfolio Analytics</div>
                    </div>
                </div>
                <div class="header-controls">
                    <div class="date-range-selector">
                        <span>üìÖ</span>
                        <input type="date" id="startDate" value="2025-01-01" />
                        <span>‚Üí</span>
                        <input type="date" id="endDate" value="2025-06-05" />
                    </div>
                    <button class="btn" onclick="toggleFilters()">
                        <span class="btn-icon">üîç</span> Filters
                    </button>
                    <div style="position: relative">
                        <button class="btn" onclick="toggleExportMenu()">
                            <span class="btn-icon">üì§</span> Export
                        </button>
                        <div class="export-menu" id="exportMenu">
                            <div class="export-option" onclick="exportToPDF()">
                                <span>üìÑ</span> Export as PDF
                            </div>
                            <div class="export-option" onclick="exportToExcel()">
                                <span>üìä</span> Export as Excel
                            </div>
                            <div class="export-option" onclick="exportToImage()">
                                <span>üñºÔ∏è</span> Export as Image
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="showUploadModal()">
                        <span class="btn-icon">üìÅ</span> Upload Data
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Dashboard -->
        <div class="dashboard-container">
            <!-- Alert Banner -->
            <div class="alert-banner" id="alertBanner">
                <div class="alert-content">
                    <span class="alert-icon">‚ö°</span>
                    <span class="alert-text"
                        >3 investments require attention: Bitcoin (+104%), Tech Strategy (-5%),
                        Relay Europe (Pending deployment)</span
                    >
                </div>
                <span class="alert-close" onclick="closeAlert()">‚úï</span>
            </div>

            <!-- Filter Panel -->
            <div class="filter-panel" id="filterPanel">
                <div class="filter-group">
                    <label class="filter-label">Asset Category</label>
                    <div class="filter-options">
                        <div
                            class="filter-chip active"
                            onclick="toggleFilter(this, 'category', 'all')"
                        >
                            All
                        </div>
                        <div
                            class="filter-chip"
                            onclick="toggleFilter(this, 'category', 'search-funds')"
                        >
                            Search Funds
                        </div>
                        <div class="filter-chip" onclick="toggleFilter(this, 'category', 'vc')">
                            Venture Capital
                        </div>
                        <div class="filter-chip" onclick="toggleFilter(this, 'category', 'other')">
                            Other Assets
                        </div>
                    </div>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Performance Range</label>
                    <div class="filter-options">
                        <div
                            class="filter-chip active"
                            onclick="toggleFilter(this, 'performance', 'all')"
                        >
                            All
                        </div>
                        <div
                            class="filter-chip"
                            onclick="toggleFilter(this, 'performance', 'positive')"
                        >
                            Positive (>0%)
                        </div>
                        <div
                            class="filter-chip"
                            onclick="toggleFilter(this, 'performance', 'high')"
                        >
                            High (>15%)
                        </div>
                        <div
                            class="filter-chip"
                            onclick="toggleFilter(this, 'performance', 'negative')"
                        >
                            Negative (<0%)
                        </div>
                    </div>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Investment Status</label>
                    <div class="filter-options">
                        <div
                            class="filter-chip active"
                            onclick="toggleFilter(this, 'status', 'all')"
                        >
                            All
                        </div>
                        <div class="filter-chip" onclick="toggleFilter(this, 'status', 'active')">
                            Active
                        </div>
                        <div class="filter-chip" onclick="toggleFilter(this, 'status', 'new')">
                            New
                        </div>
                        <div class="filter-chip" onclick="toggleFilter(this, 'status', 'pipeline')">
                            Pipeline
                        </div>
                    </div>
                </div>
            </div>

            <!-- Key Metrics -->
            <div class="metrics-grid">
                <div class="metric-card" onclick="showMetricDetails('portfolio')">
                    <div class="metric-icon">üíº</div>
                    <div class="metric-label">Total Portfolio Value</div>
                    <div class="metric-value">
                        $14.23M
                        <span style="font-size: 0.5em; color: var(--text-secondary)">USD</span>
                    </div>
                    <div class="metric-change positive"><span>‚ñ≤</span> $4.28M (+42.7%) YTD</div>
                    <canvas class="metric-sparkline" id="portfolioSparkline"></canvas>
                </div>

                <div class="metric-card" onclick="showMetricDetails('liquidity')">
                    <div class="metric-icon">üí∞</div>
                    <div class="metric-label">Available Liquidity</div>
                    <div class="metric-value">
                        $11.14M
                        <span style="font-size: 0.5em; color: var(--text-secondary)">78.3%</span>
                    </div>
                    <div class="metric-change neutral"><span>‚Ä¢</span> $5.15M deployed</div>
                    <canvas class="metric-sparkline" id="liquiditySparkline"></canvas>
                </div>

                <div class="metric-card" onclick="showMetricDetails('returns')">
                    <div class="metric-icon">üìà</div>
                    <div class="metric-label">Weighted Avg Return</div>
                    <div class="metric-value">
                        18.5%
                        <span style="font-size: 0.5em; color: var(--text-secondary)">IRR</span>
                    </div>
                    <div class="metric-change positive">
                        <span>‚ñ≤</span> Outperforming S&P by 6.2%
                    </div>
                    <canvas class="metric-sparkline" id="returnsSparkline"></canvas>
                </div>

                <div class="metric-card" onclick="showMetricDetails('risk')">
                    <div class="metric-icon">‚ö°</div>
                    <div class="metric-label">Risk Score</div>
                    <div class="metric-value">
                        3.2/10
                        <span style="font-size: 0.5em; color: var(--accent-green)">Low</span>
                    </div>
                    <div class="metric-change positive"><span>‚ñº</span> -0.8 from last quarter</div>
                    <canvas class="metric-sparkline" id="riskSparkline"></canvas>
                </div>
            </div>

            <!-- Navigation Tabs -->
            <div class="tabs-container">
                <button class="tab active" onclick="switchTab('overview')">üìä Overview</button>
                <button class="tab" onclick="switchTab('portfolio')">üíº Portfolio Analysis</button>
                <button class="tab" onclick="switchTab('performance')">üìà Performance</button>
                <button class="tab" onclick="switchTab('risk')">‚ö° Risk Management</button>
                <button class="tab" onclick="switchTab('projections')">üîÆ Projections</button>
                <button class="tab" onclick="switchTab('reports')">üìÑ Reports</button>
            </div>

            <!-- Main Content Area -->
            <div id="mainContent">
                <!-- Overview Tab Content -->
                <div id="overviewContent" class="tab-content">
                    <div class="charts-grid">
                        <!-- Portfolio Allocation Sunburst -->
                        <div class="chart-container">
                            <div class="chart-header">
                                <div>
                                    <h3 class="chart-title">Portfolio Allocation Breakdown</h3>
                                    <p class="chart-subtitle">
                                        Interactive hierarchical view - Click to drill down
                                    </p>
                                </div>
                                <div class="chart-controls">
                                    <button
                                        class="chart-btn active"
                                        onclick="updateAllocation('current')"
                                    >
                                        Current
                                    </button>
                                    <button class="chart-btn" onclick="updateAllocation('target')">
                                        Target 2025
                                    </button>
                                    <button class="chart-btn" onclick="updateAllocation('compare')">
                                        Compare
                                    </button>
                                </div>
                            </div>
                            <canvas id="allocationChart"></canvas>
                        </div>

                        <!-- Investment Performance Matrix -->
                        <div class="chart-container">
                            <div class="chart-header">
                                <div>
                                    <h3 class="chart-title">Performance Matrix</h3>
                                    <p class="chart-subtitle">
                                        Size = Investment, Position = Risk/Return
                                    </p>
                                </div>
                                <div class="chart-controls">
                                    <button class="chart-btn" onclick="togglePerformanceView()">
                                        üîÑ Switch View
                                    </button>
                                </div>
                            </div>
                            <canvas id="performanceMatrix"></canvas>
                        </div>

                        <!-- Budget vs Execution -->
                        <div class="chart-container full-width">
                            <div class="chart-header">
                                <div>
                                    <h3 class="chart-title">Budget vs Execution Analysis</h3>
                                    <p class="chart-subtitle">
                                        Monthly variance tracking with drill-down capability
                                    </p>
                                </div>
                                <div class="chart-controls">
                                    <button
                                        class="chart-btn active"
                                        onclick="updateBudgetView('waterfall')"
                                    >
                                        Waterfall
                                    </button>
                                    <button
                                        class="chart-btn"
                                        onclick="updateBudgetView('variance')"
                                    >
                                        Variance
                                    </button>
                                    <button class="chart-btn" onclick="updateBudgetView('trend')">
                                        Trend
                                    </button>
                                </div>
                            </div>
                            <canvas id="budgetChart"></canvas>
                        </div>

                        <!-- Investment Table -->
                        <div class="chart-container full-width">
                            <div class="chart-header">
                                <div>
                                    <h3 class="chart-title">Portfolio Holdings Detail</h3>
                                    <p class="chart-subtitle">
                                        Click any row for detailed analytics
                                    </p>
                                </div>
                                <div class="chart-controls">
                                    <button class="chart-btn" onclick="downloadTableData()">
                                        üì• Download
                                    </button>
                                </div>
                            </div>
                            <div class="search-container">
                                <span class="search-icon">üîç</span>
                                <input
                                    type="text"
                                    class="search-input"
                                    placeholder="Search investments..."
                                    onkeyup="filterTable(this.value)"
                                />
                            </div>
                            <div class="data-table-container">
                                <table class="data-table" id="investmentTable">
                                    <thead>
                                        <tr>
                                            <th onclick="sortTable('name')">Investment ‚Üï</th>
                                            <th onclick="sortTable('category')">Category ‚Üï</th>
                                            <th onclick="sortTable('commitment')">Commitment ‚Üï</th>
                                            <th onclick="sortTable('deployed')">Deployed ‚Üï</th>
                                            <th onclick="sortTable('nav')">NAV ‚Üï</th>
                                            <th onclick="sortTable('return')">Return % ‚Üï</th>
                                            <th onclick="sortTable('irr')">IRR ‚Üï</th>
                                            <th>Performance</th>
                                            <th onclick="sortTable('status')">Status ‚Üï</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="investmentTableBody">
                                        <!-- Populated by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Liquidity Dashboard -->
                        <div class="chart-container">
                            <div class="chart-header">
                                <div>
                                    <h3 class="chart-title">Liquidity & Cash Management</h3>
                                    <p class="chart-subtitle">Real-time liquidity positions</p>
                                </div>
                            </div>
                            <canvas id="liquidityChart"></canvas>
                            <div
                                style="
                                    display: grid;
                                    grid-template-columns: repeat(3, 1fr);
                                    gap: 15px;
                                    margin-top: 20px;
                                "
                            >
                                <div
                                    style="
                                        background: var(--secondary-bg);
                                        padding: 15px;
                                        border-radius: 10px;
                                        text-align: center;
                                    "
                                >
                                    <div style="color: var(--text-secondary); font-size: 0.85rem">
                                        Bitcoin
                                    </div>
                                    <div
                                        style="font-size: 1.5rem; font-weight: bold; color: #f59e0b"
                                    >
                                        $4.09M
                                    </div>
                                    <div style="color: var(--accent-green); font-size: 0.85rem">
                                        +104.4%
                                    </div>
                                </div>
                                <div
                                    style="
                                        background: var(--secondary-bg);
                                        padding: 15px;
                                        border-radius: 10px;
                                        text-align: center;
                                    "
                                >
                                    <div style="color: var(--text-secondary); font-size: 0.85rem">
                                        JPM Fund
                                    </div>
                                    <div
                                        style="font-size: 1.5rem; font-weight: bold; color: #3b82f6"
                                    >
                                        $5.75M
                                    </div>
                                    <div style="color: var(--accent-green); font-size: 0.85rem">
                                        +2.1%
                                    </div>
                                </div>
                                <div
                                    style="
                                        background: var(--secondary-bg);
                                        padding: 15px;
                                        border-radius: 10px;
                                        text-align: center;
                                    "
                                >
                                    <div style="color: var(--text-secondary); font-size: 0.85rem">
                                        Gold
                                    </div>
                                    <div
                                        style="font-size: 1.5rem; font-weight: bold; color: #eab308"
                                    >
                                        $1.30M
                                    </div>
                                    <div style="color: var(--accent-green); font-size: 0.85rem">
                                        +8.3%
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Geographic Distribution -->
                        <div class="chart-container">
                            <div class="chart-header">
                                <div>
                                    <h3 class="chart-title">Geographic Distribution</h3>
                                    <p class="chart-subtitle">Investment allocation by region</p>
                                </div>
                            </div>
                            <canvas id="geoChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal -->
        <div class="modal" id="detailModal">
            <div class="modal-content">
                <div class="modal-close" onclick="closeModal()">‚úï</div>
                <div id="modalContent">
                    <!-- Dynamic content -->
                </div>
            </div>
        </div>

        <!-- Upload Modal -->
        <div class="modal" id="uploadModal">
            <div class="modal-content">
                <div class="modal-close" onclick="closeUploadModal()">‚úï</div>
                <h2 style="margin-bottom: 25px">Upload Excel Files</h2>
                <div
                    class="file-upload-area"
                    id="uploadArea"
                    ondrop="handleDrop(event)"
                    ondragover="handleDragOver(event)"
                    ondragleave="handleDragLeave(event)"
                >
                    <div class="upload-icon">üìÅ</div>
                    <p class="upload-text">Drag and drop Excel files here or click to browse</p>
                    <input
                        type="file"
                        id="fileInput"
                        accept=".xlsx,.xls"
                        multiple
                        style="display: none"
                        onchange="handleFileSelect(event)"
                    />
                    <button
                        class="upload-button"
                        onclick="document.getElementById('fileInput').click()"
                    >
                        Choose Files
                    </button>
                </div>
                <div id="uploadedFiles"></div>
            </div>
        </div>

        <!-- Tooltip -->
        <div class="tooltip" id="tooltip"></div>

        <script>
            // Global variables
            let charts = {}
            let currentTab = 'overview'
            let filters = {
                category: 'all',
                performance: 'all',
                status: 'all'
            }

            // Portfolio data
            const portfolioData = {
                investments: [
                    {
                        name: 'Ambit Partners Fund II',
                        category: 'Search Funds',
                        commitment: 500000,
                        deployed: 43855,
                        nav: 45000,
                        return: 2.7,
                        irr: 8.5,
                        status: 'Active',
                        vintage: '2024',
                        region: 'Global',
                        risk: 3.2
                    },
                    {
                        name: 'Vonzeo Capital Partners III',
                        category: 'Search Funds',
                        commitment: 530000,
                        deployed: 53000,
                        nav: 58000,
                        return: 9.4,
                        irr: 15.2,
                        status: 'Active',
                        vintage: '2024',
                        region: 'Europe',
                        risk: 3.5
                    },
                    {
                        name: 'Relay Europe',
                        category: 'Search Funds',
                        commitment: 550000,
                        deployed: 0,
                        nav: 0,
                        return: 0,
                        irr: 0,
                        status: 'New',
                        vintage: '2025',
                        region: 'Europe',
                        risk: 4.0
                    },
                    {
                        name: 'Carao Ventures',
                        category: 'LatAm VC',
                        commitment: 250000,
                        deployed: 125000,
                        nav: 145000,
                        return: 16.0,
                        irr: 22.5,
                        status: 'Active',
                        vintage: '2023',
                        region: 'Latin America',
                        risk: 4.5
                    },
                    {
                        name: 'K50 Ventures',
                        category: 'LatAm VC',
                        commitment: 200000,
                        deployed: 50000,
                        nav: 52000,
                        return: 4.0,
                        irr: 12.0,
                        status: 'Active',
                        vintage: '2024',
                        region: 'Latin America',
                        risk: 4.2
                    },
                    {
                        name: 'Monashees',
                        category: 'LatAm VC',
                        commitment: 500000,
                        deployed: 0,
                        nav: 0,
                        return: 0,
                        irr: 0,
                        status: 'New',
                        vintage: '2025',
                        region: 'Latin America',
                        risk: 4.8
                    },
                    {
                        name: 'CAZ SOF',
                        category: 'SOF',
                        commitment: 2000000,
                        deployed: 2000000,
                        nav: 2450000,
                        return: 22.5,
                        irr: 18.7,
                        status: 'Active',
                        vintage: '2023',
                        region: 'North America',
                        risk: 2.8
                    },
                    {
                        name: 'The Estate by SBE',
                        category: 'Real Estate',
                        commitment: 250000,
                        deployed: 250000,
                        nav: 275000,
                        return: 10.0,
                        irr: 8.2,
                        status: 'Active',
                        vintage: '2024',
                        region: 'North America',
                        risk: 3.0
                    },
                    {
                        name: 'Bitcoin',
                        category: 'Digital Assets',
                        commitment: 2000000,
                        deployed: 2000000,
                        nav: 4088000,
                        return: 104.4,
                        irr: 85.2,
                        status: 'Active',
                        vintage: '2023',
                        region: 'Global',
                        risk: 8.5
                    },
                    {
                        name: 'Argentina Strategy',
                        category: 'Macro',
                        commitment: 1000000,
                        deployed: 0,
                        nav: 0,
                        return: 0,
                        irr: 0,
                        status: 'Pipeline',
                        vintage: '2025',
                        region: 'Latin America',
                        risk: 7.0
                    },
                    {
                        name: 'Tech Strategy (AI/Robotics)',
                        category: 'Technology',
                        commitment: 1500000,
                        deployed: 100000,
                        nav: 95000,
                        return: -5.0,
                        irr: -12.5,
                        status: 'Active',
                        vintage: '2025',
                        region: 'Global',
                        risk: 6.5
                    },
                    {
                        name: 'Value Investing',
                        category: 'Public Equity',
                        commitment: 1000000,
                        deployed: 200000,
                        nav: 215000,
                        return: 7.5,
                        irr: 15.8,
                        status: 'Active',
                        vintage: '2024',
                        region: 'Global',
                        risk: 4.0
                    }
                ],
                allocations: {
                    current: [
                        { name: 'Search Funds', value: 39, amount: 5580 },
                        { name: 'Digital Assets', value: 28.7, amount: 4088 },
                        { name: 'CAZ SOF', value: 14, amount: 2000 },
                        { name: 'LatAm VC', value: 6.7, amount: 950 },
                        { name: 'Other', value: 11.6, amount: 1612 }
                    ],
                    target2025: [
                        { name: 'Search Funds', value: 35, amount: 5000 },
                        { name: 'Digital Assets', value: 20, amount: 2850 },
                        { name: 'CAZ SOF', value: 15, amount: 2140 },
                        { name: 'LatAm VC', value: 10, amount: 1425 },
                        { name: 'Other', value: 20, amount: 2850 }
                    ]
                },
                monthlyData: {
                    months: [
                        'Jan',
                        'Feb',
                        'Mar',
                        'Apr',
                        'May',
                        'Jun',
                        'Jul',
                        'Aug',
                        'Sep',
                        'Oct',
                        'Nov',
                        'Dec'
                    ],
                    revenue: [450, 480, 520, 490, 550, 580, 620, 640, 680, 720, 750, 780],
                    expenses: [120, 125, 130, 128, 135, 140, 145, 150, 155, 160, 165, 170],
                    budget: [440, 470, 510, 500, 540, 570, 610, 630, 670, 710, 740, 770],
                    portfolioValue: [
                        12500, 12800, 13100, 13000, 13400, 13800, 14000, 14100, 14150, 14200, 14220,
                        14230
                    ]
                },
                geographic: {
                    'North America': { value: 3500, count: 3, avgReturn: 15.2 },
                    'Latin America': { value: 4200, count: 4, avgReturn: 22.5 },
                    Europe: { value: 2100, count: 2, avgReturn: 12.8 },
                    Global: { value: 4430, count: 3, avgReturn: 35.6 }
                }
            }

            // Initialize dashboard
            window.addEventListener('load', () => {
                setTimeout(() => {
                    document.getElementById('loadingScreen').style.opacity = '0'
                    setTimeout(() => {
                        document.getElementById('loadingScreen').style.display = 'none'
                    }, 500)
                }, 1500)

                initializeCharts()
                populateTable()
                initializeSparklines()
                setupEventListeners()
            })

            // Chart initialization
            function initializeCharts() {
                Chart.defaults.color = '#a0a0b0'
                Chart.defaults.borderColor = '#2a2a3e'
                Chart.defaults.font.family =
                    "-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif"

                // Portfolio Allocation Chart (Sunburst/Doughnut)
                const allocationCtx = document.getElementById('allocationChart').getContext('2d')
                charts.allocation = new Chart(allocationCtx, {
                    type: 'doughnut',
                    data: {
                        labels: portfolioData.allocations.current.map(item => item.name),
                        datasets: [
                            {
                                data: portfolioData.allocations.current.map(item => item.value),
                                backgroundColor: [
                                    'rgba(59, 130, 246, 0.8)',
                                    'rgba(139, 92, 246, 0.8)',
                                    'rgba(16, 185, 129, 0.8)',
                                    'rgba(245, 158, 11, 0.8)',
                                    'rgba(239, 68, 68, 0.8)'
                                ],
                                borderColor: [
                                    'rgba(59, 130, 246, 1)',
                                    'rgba(139, 92, 246, 1)',
                                    'rgba(16, 185, 129, 1)',
                                    'rgba(245, 158, 11, 1)',
                                    'rgba(239, 68, 68, 1)'
                                ],
                                borderWidth: 2,
                                hoverOffset: 20
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 20,
                                    usePointStyle: true,
                                    font: {
                                        size: 12
                                    }
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function (context) {
                                        const label = context.label || ''
                                        const value = context.parsed || 0
                                        const amount =
                                            portfolioData.allocations.current[context.dataIndex]
                                                .amount
                                        return `${label}: ${value}% ($${amount.toLocaleString()}k)`
                                    }
                                }
                            }
                        },
                        onClick: (event, elements) => {
                            if (elements.length > 0) {
                                const index = elements[0].index
                                showAllocationDetails(portfolioData.allocations.current[index])
                            }
                        }
                    }
                })

                // Performance Matrix (Bubble Chart)
                const performanceCtx = document.getElementById('performanceMatrix').getContext('2d')
                charts.performance = new Chart(performanceCtx, {
                    type: 'bubble',
                    data: {
                        datasets: [
                            {
                                label: 'Investments',
                                data: portfolioData.investments.map(inv => ({
                                    x: inv.risk,
                                    y: inv.return,
                                    r: Math.sqrt(inv.commitment) / 200,
                                    investment: inv
                                })),
                                backgroundColor: function (context) {
                                    const value = context.raw.y
                                    if (value > 15) return 'rgba(16, 185, 129, 0.6)'
                                    if (value > 0) return 'rgba(59, 130, 246, 0.6)'
                                    return 'rgba(239, 68, 68, 0.6)'
                                },
                                borderColor: function (context) {
                                    const value = context.raw.y
                                    if (value > 15) return 'rgba(16, 185, 129, 1)'
                                    if (value > 0) return 'rgba(59, 130, 246, 1)'
                                    return 'rgba(239, 68, 68, 1)'
                                },
                                borderWidth: 2
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Risk Score ‚Üí'
                                },
                                min: 0,
                                max: 10
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'Return % ‚Üí'
                                },
                                min: -20,
                                max: 120
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function (context) {
                                        const inv = context.raw.investment
                                        return [
                                            `${inv.name}`,
                                            `Return: ${inv.return}%`,
                                            `Risk: ${inv.risk}/10`,
                                            `Size: $${(inv.commitment / 1000000).toFixed(1)}M`
                                        ]
                                    }
                                }
                            }
                        },
                        onClick: (event, elements) => {
                            if (elements.length > 0) {
                                const inv = elements[0].element.$context.raw.investment
                                showInvestmentDetails(inv)
                            }
                        }
                    }
                })

                // Budget Chart
                const budgetCtx = document.getElementById('budgetChart').getContext('2d')
                charts.budget = new Chart(budgetCtx, {
                    type: 'bar',
                    data: {
                        labels: [
                            'Q1 Budget',
                            '+Revenue',
                            '-Expenses',
                            '=Q1 Actual',
                            'Q2 Budget',
                            '+Revenue',
                            '-Expenses',
                            '=Q2 Actual'
                        ],
                        datasets: [
                            {
                                label: 'Waterfall',
                                data: [1200, 350, -280, 1270, 1300, 420, -300, 1420],
                                backgroundColor: function (context) {
                                    const label = context.chart.data.labels[context.dataIndex]
                                    if (label.includes('+')) return 'rgba(16, 185, 129, 0.8)'
                                    if (label.includes('-')) return 'rgba(239, 68, 68, 0.8)'
                                    if (label.includes('=')) return 'rgba(139, 92, 246, 0.8)'
                                    return 'rgba(59, 130, 246, 0.8)'
                                },
                                borderColor: function (context) {
                                    const label = context.chart.data.labels[context.dataIndex]
                                    if (label.includes('+')) return 'rgba(16, 185, 129, 1)'
                                    if (label.includes('-')) return 'rgba(239, 68, 68, 1)'
                                    if (label.includes('=')) return 'rgba(139, 92, 246, 1)'
                                    return 'rgba(59, 130, 246, 1)'
                                },
                                borderWidth: 2,
                                barPercentage: 0.8
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function (context) {
                                        const value = context.parsed.y
                                        const prefix = value > 0 ? '+' : ''
                                        return `${prefix}$${value.toLocaleString()}k`
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function (value) {
                                        return '$' + value + 'k'
                                    }
                                }
                            }
                        }
                    }
                })

                // Liquidity Chart
                const liquidityCtx = document.getElementById('liquidityChart').getContext('2d')
                charts.liquidity = new Chart(liquidityCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Total Capital', 'Deployed', 'Committed', 'Available'],
                        datasets: [
                            {
                                label: 'Amount',
                                data: [14230, 5150, 2942, 11138],
                                backgroundColor: [
                                    'rgba(59, 130, 246, 0.8)',
                                    'rgba(139, 92, 246, 0.8)',
                                    'rgba(245, 158, 11, 0.8)',
                                    'rgba(16, 185, 129, 0.8)'
                                ],
                                borderColor: [
                                    'rgba(59, 130, 246, 1)',
                                    'rgba(139, 92, 246, 1)',
                                    'rgba(245, 158, 11, 1)',
                                    'rgba(16, 185, 129, 1)'
                                ],
                                borderWidth: 2
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function (context) {
                                        return `$${context.parsed.y.toLocaleString()}k`
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function (value) {
                                        return '$' + value + 'k'
                                    }
                                }
                            }
                        }
                    }
                })

                // Geographic Chart
                const geoCtx = document.getElementById('geoChart').getContext('2d')
                charts.geo = new Chart(geoCtx, {
                    type: 'radar',
                    data: {
                        labels: Object.keys(portfolioData.geographic),
                        datasets: [
                            {
                                label: 'Investment Value',
                                data: Object.values(portfolioData.geographic).map(r => r.value),
                                backgroundColor: 'rgba(59, 130, 246, 0.2)',
                                borderColor: 'rgba(59, 130, 246, 1)',
                                borderWidth: 2,
                                pointBackgroundColor: 'rgba(59, 130, 246, 1)',
                                pointBorderColor: '#fff',
                                pointBorderWidth: 2,
                                pointRadius: 5
                            },
                            {
                                label: 'Average Return',
                                data: Object.values(portfolioData.geographic).map(
                                    r => r.avgReturn * 100
                                ),
                                backgroundColor: 'rgba(16, 185, 129, 0.2)',
                                borderColor: 'rgba(16, 185, 129, 1)',
                                borderWidth: 2,
                                pointBackgroundColor: 'rgba(16, 185, 129, 1)',
                                pointBorderColor: '#fff',
                                pointBorderWidth: 2,
                                pointRadius: 5
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            r: {
                                beginAtZero: true,
                                ticks: {
                                    display: false
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                })
            }

            // Populate investment table
            function populateTable() {
                const tbody = document.getElementById('investmentTableBody')
                tbody.innerHTML = ''

                const filteredInvestments = portfolioData.investments.filter(inv => {
                    if (
                        filters.category !== 'all' &&
                        !inv.category.toLowerCase().includes(filters.category)
                    )
                        return false
                    if (filters.performance === 'positive' && inv.return <= 0) return false
                    if (filters.performance === 'high' && inv.return <= 15) return false
                    if (filters.performance === 'negative' && inv.return >= 0) return false
                    if (filters.status !== 'all' && inv.status.toLowerCase() !== filters.status)
                        return false
                    return true
                })

                filteredInvestments.forEach(inv => {
                    const row = document.createElement('tr')
                    const deploymentPercent = ((inv.deployed / inv.commitment) * 100).toFixed(1)

                    row.innerHTML = `
                    <td style="font-weight: 500;">${inv.name}</td>
                    <td>${inv.category}</td>
                    <td>$${(inv.commitment / 1000).toLocaleString()}k</td>
                    <td>$${(inv.deployed / 1000).toLocaleString()}k</td>
                    <td>$${(inv.nav / 1000).toLocaleString()}k</td>
                    <td style="color: ${inv.return > 0 ? 'var(--accent-green)' : 'var(--accent-red)'}; font-weight: 600;">
                        ${inv.return > 0 ? '+' : ''}${inv.return.toFixed(1)}%
                    </td>
                    <td style="color: ${inv.irr > 0 ? 'var(--accent-green)' : 'var(--accent-red)'};">
                        ${inv.irr.toFixed(1)}%
                    </td>
                    <td>
                        <div class="performance-bar">
                            <div class="performance-fill" style="width: ${deploymentPercent}%; background: ${
                                deploymentPercent > 80
                                    ? 'var(--accent-green)'
                                    : deploymentPercent > 50
                                      ? 'var(--accent-blue)'
                                      : 'var(--accent-yellow)'
                            }"></div>
                        </div>
                        <small style="color: var(--text-secondary);">${deploymentPercent}% deployed</small>
                    </td>
                    <td>
                        <span class="table-badge badge-${inv.status.toLowerCase()}">${inv.status}</span>
                    </td>
                    <td>
                        <button class="chart-btn" onclick="showInvestmentDetails(${JSON.stringify(inv).replace(/"/g, '&quot;')})">Details</button>
                    </td>
                `

                    tbody.appendChild(row)
                })
            }

            // Initialize sparklines
            function initializeSparklines() {
                const sparklineOptions = {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false }
                    },
                    scales: {
                        x: { display: false },
                        y: { display: false }
                    },
                    elements: {
                        point: { radius: 0 },
                        line: { borderWidth: 2 }
                    }
                }

                // Portfolio sparkline
                const portfolioSparkCtx = document
                    .getElementById('portfolioSparkline')
                    .getContext('2d')
                new Chart(portfolioSparkCtx, {
                    type: 'line',
                    data: {
                        labels: portfolioData.monthlyData.months.slice(-6),
                        datasets: [
                            {
                                data: portfolioData.monthlyData.portfolioValue.slice(-6),
                                borderColor: 'rgba(16, 185, 129, 0.8)',
                                backgroundColor: 'transparent'
                            }
                        ]
                    },
                    options: sparklineOptions
                })

                // Other sparklines would follow similar pattern
            }

            // Event listeners setup
            function setupEventListeners() {
                // Date range change
                document.getElementById('startDate').addEventListener('change', updateDateRange)
                document.getElementById('endDate').addEventListener('change', updateDateRange)

                // Window resize
                window.addEventListener('resize', () => {
                    Object.values(charts).forEach(chart => chart.resize())
                })
            }

            // Interactive functions
            function switchTab(tabName) {
                currentTab = tabName
                document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'))
                event.target.classList.add('active')

                // Here you would show/hide different content based on tab
                console.log('Switching to tab:', tabName)
            }

            function toggleFilters() {
                const filterPanel = document.getElementById('filterPanel')
                filterPanel.classList.toggle('active')
            }

            function toggleFilter(element, filterType, value) {
                // Update active state
                element.parentElement.querySelectorAll('.filter-chip').forEach(chip => {
                    chip.classList.remove('active')
                })
                element.classList.add('active')

                // Update filter
                filters[filterType] = value

                // Refresh table
                populateTable()
            }

            function filterTable(searchTerm) {
                const rows = document
                    .getElementById('investmentTableBody')
                    .getElementsByTagName('tr')
                const term = searchTerm.toLowerCase()

                Array.from(rows).forEach(row => {
                    const text = row.textContent.toLowerCase()
                    row.style.display = text.includes(term) ? '' : 'none'
                })
            }

            function sortTable(column) {
                // Implement table sorting
                console.log('Sorting by:', column)
            }

            function showInvestmentDetails(investment) {
                const modalContent = document.getElementById('modalContent')
                modalContent.innerHTML = `
                <h2>${investment.name}</h2>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-top: 25px;">
                    <div>
                        <h4 style="color: var(--text-secondary); margin-bottom: 15px;">Investment Overview</h4>
                        <div style="background: var(--secondary-bg); padding: 20px; border-radius: 10px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span>Category</span>
                                <strong>${investment.category}</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span>Status</span>
                                <span class="table-badge badge-${investment.status.toLowerCase()}">${investment.status}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span>Vintage</span>
                                <strong>${investment.vintage}</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>Region</span>
                                <strong>${investment.region}</strong>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h4 style="color: var(--text-secondary); margin-bottom: 15px;">Financial Metrics</h4>
                        <div style="background: var(--secondary-bg); padding: 20px; border-radius: 10px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span>Commitment</span>
                                <strong>$${(investment.commitment / 1000).toLocaleString()}k</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span>Deployed</span>
                                <strong>$${(investment.deployed / 1000).toLocaleString()}k</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span>NAV</span>
                                <strong>$${(investment.nav / 1000).toLocaleString()}k</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>Return</span>
                                <strong style="color: ${investment.return > 0 ? 'var(--accent-green)' : 'var(--accent-red)'}">
                                    ${investment.return > 0 ? '+' : ''}${investment.return.toFixed(1)}%
                                </strong>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="margin-top: 25px;">
                    <h4 style="color: var(--text-secondary); margin-bottom: 15px;">Performance Analysis</h4>
                    <canvas id="modalChart" style="height: 300px;"></canvas>
                </div>
            `

                showModal()

                // Create performance chart in modal
                setTimeout(() => {
                    const ctx = document.getElementById('modalChart').getContext('2d')
                    new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: [
                                'Q1 2024',
                                'Q2 2024',
                                'Q3 2024',
                                'Q4 2024',
                                'Q1 2025',
                                'Q2 2025'
                            ],
                            datasets: [
                                {
                                    label: 'NAV',
                                    data: [
                                        100,
                                        102,
                                        105,
                                        108,
                                        110,
                                        (investment.nav / investment.commitment) * 100
                                    ],
                                    borderColor: 'rgba(59, 130, 246, 1)',
                                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                    borderWidth: 2,
                                    tension: 0.4
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display: false
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: false,
                                    ticks: {
                                        callback: function (value) {
                                            return value + '%'
                                        }
                                    }
                                }
                            }
                        }
                    })
                }, 100)
            }

            function showMetricDetails(metric) {
                console.log('Showing details for:', metric)
                // Implement metric drill-down
            }

            function showAllocationDetails(allocation) {
                console.log('Showing allocation details:', allocation)
                // Implement allocation drill-down
            }

            function updateAllocation(view) {
                const data =
                    view === 'current'
                        ? portfolioData.allocations.current
                        : portfolioData.allocations.target2025
                charts.allocation.data.labels = data.map(item => item.name)
                charts.allocation.data.datasets[0].data = data.map(item => item.value)
                charts.allocation.update()

                // Update button states
                document
                    .querySelectorAll('.chart-controls button')
                    .forEach(btn => btn.classList.remove('active'))
                event.target.classList.add('active')
            }

            function updateBudgetView(view) {
                console.log('Updating budget view:', view)
                // Implement different budget views
            }

            function togglePerformanceView() {
                // Toggle between different performance views
                console.log('Toggling performance view')
            }

            function showModal() {
                document.getElementById('detailModal').classList.add('active')
            }

            function closeModal() {
                document.getElementById('detailModal').classList.remove('active')
            }

            function showUploadModal() {
                document.getElementById('uploadModal').classList.add('active')
            }

            function closeUploadModal() {
                document.getElementById('uploadModal').classList.remove('active')
            }

            function closeAlert() {
                document.getElementById('alertBanner').style.display = 'none'
            }

            function toggleExportMenu() {
                document.getElementById('exportMenu').classList.toggle('active')
            }

            function exportToPDF() {
                console.log('Exporting to PDF...')
                // Implement PDF export
            }

            function exportToExcel() {
                console.log('Exporting to Excel...')
                // Implement Excel export
            }

            function exportToImage() {
                console.log('Exporting to Image...')
                // Implement image export
            }

            function downloadTableData() {
                console.log('Downloading table data...')
                // Implement table download
            }

            function updateDateRange() {
                const startDate = document.getElementById('startDate').value
                const endDate = document.getElementById('endDate').value
                console.log('Date range updated:', startDate, 'to', endDate)
                // Implement date range filtering
            }

            // File upload handlers
            function handleDragOver(e) {
                e.preventDefault()
                document.getElementById('uploadArea').classList.add('dragover')
            }

            function handleDragLeave(e) {
                e.preventDefault()
                document.getElementById('uploadArea').classList.remove('dragover')
            }

            function handleDrop(e) {
                e.preventDefault()
                document.getElementById('uploadArea').classList.remove('dragover')
                const files = e.dataTransfer.files
                handleFiles(files)
            }

            function handleFileSelect(e) {
                const files = e.target.files
                handleFiles(files)
            }

            function handleFiles(files) {
                const fileList = document.getElementById('uploadedFiles')
                fileList.innerHTML = '<h4 style="margin-top: 20px;">Uploaded Files:</h4>'

                Array.from(files).forEach(file => {
                    if (file.name.endsWith('.xlsx') || file.name.endsWith('.xls')) {
                        const fileDiv = document.createElement('div')
                        fileDiv.style.cssText =
                            'background: var(--secondary-bg); padding: 15px; border-radius: 8px; margin-top: 10px; display: flex; justify-content: space-between; align-items: center;'
                        fileDiv.innerHTML = `
                        <span>üìä ${file.name}</span>
                        <span style="color: var(--accent-green);">‚úì Ready to process</span>
                    `
                        fileList.appendChild(fileDiv)

                        // Process Excel file
                        const reader = new FileReader()
                        reader.onload = function (e) {
                            const data = new Uint8Array(e.target.result)
                            const workbook = XLSX.read(data, { type: 'array' })
                            console.log('Workbook loaded:', workbook.SheetNames)
                            // Process workbook data
                        }
                        reader.readAsArrayBuffer(file)
                    }
                })
            }

            // Auto-refresh functionality
            setInterval(() => {
                // Simulate real-time updates
                const portfolioValue = document.querySelector('.metric-value')
                const currentValue = parseFloat(
                    portfolioValue.textContent.replace('$', '').replace('M', '')
                )
                const variation = (Math.random() - 0.5) * 0.1
                const newValue = currentValue + variation
                portfolioValue.innerHTML = `$${newValue.toFixed(2)}M <span style="font-size: 0.5em; color: var(--text-secondary);">USD</span>`
            }, 30000) // Update every 30 seconds
        </script>
    </body>
</html>
